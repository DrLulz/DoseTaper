/*!
 * Float Labels
 *
 * Version: 2.0.1
 * Author: Paul Ryley (http://geminilabs.io)
 * URL: https://github.com/geminilabs/float-labels.js
 * License: MIT
 */
/** global: Option */
function doseParam(){
//console.log('doseParam');
$(".dose-param").floatlabels({customEvent:null,customLabel:null,exclude:".no-label",inputRegex:/email|number|password|search|tel|text|url/,prioritize:"label",requiredClass:"required",style:1,transform:"input, select, textarea"})}function daysParam(){
//console.log('daysParam')
$(".days-param").floatlabels({customEvent:null,customLabel:null,exclude:".no-label",inputRegex:/email|number|password|search|tel|text|url/,prioritize:"label",requiredClass:"required",style:1,transform:"input, select, textarea"})}function datePicker(){var a=$(".input-group-addon"),b=$("#input_date").pickadate({format:"mmmm dd, yyyy",today:'<i class="fa fa-crosshairs" aria-hidden="true"></i>',clear:"",close:'<i class="fa fa-times" aria-hidden="true"></i>',formatSubmit:"mm/dd/yyyy",hiddenName:!0,onStart:function(){var a=new Date;
//var date = new Date(2016,11,31);
this.set("select",[a.getFullYear(),a.getMonth(),a.getDate()])},onClose:function(){
//update_span();
b.text(this.get()),$(".cal-wrapper").removeClass("cal-hover"),$(document.activeElement).blur()}}),c=b.pickadate("picker");a.on("click",function(a){c.get("open")?c.close():c.open(),a.stopPropagation()}).on("mousedown",function(a){a.preventDefault()}),
//update_span();
$("#input_date").text(c.get())}function checkBoxes(){$(".checkbox:not(.noiCheck)").iCheck({checkboxClass:"icheckbox_flat-grey",radioClass:"iradio_flat-grey",
//increaseArea: '20%',
ifChecked:function(){console.log($(this).next())}}).on("ifChecked",function(a){$(this).parent().next().addClass("checked")}).on("ifUnchecked",function(a){$(this).parent().next().removeClass("checked")})}// checkboxes()
/* Delay the rearrangement of the pill size table
/* on window resize to prevent duplicate sizes.
--------------------------------------------------*/
function resizeDelay(){var a=$("table.rx").not(".hidden"),b=a.find(".row-0"),c=a.find(".row-1"),d=a.find(".row-2");
// one row
if(width()>1155)//&& !zero.length ) {
c.append(d.children()).removeClass("row-1").addClass("row-0"),d.remove();else if(b.length){var e=b.children("td").slice(0,3),f=b.children("td").slice(3,6);a.append($("<tr/>",{"class":"row-1",html:e})).append($("<tr/>",{"class":"row-2",html:f})),b.remove()}}function checkboxResize(){var a=$("table.rx").not(".hidden"),b=a.find(".row-0");
// 2 rows
if(width()<1156){var c=b.children("td").slice(0,3),d=b.children("td").slice(3,6);a.append($("<tr/>",{"class":"row-1",html:c})).append($("<tr/>",{"class":"row-2",html:d})),b.remove()}else if(!b.length){var e=a.find(".row-1"),f=a.find(".row-2");e.append(f.children()).removeClass("row-1").addClass("row-0"),f.remove()}var g;window.onresize=function(){clearTimeout(g),g=setTimeout(resizeDelay,5)},width()<lg&&$(".sup-size-wrapper").removeClass("v-align"),width()<md&&$(".sup-med-wrapper").removeClass("v-align"),$(window).resize(function(){width()<md?$(".sup-med-wrapper").removeClass("v-align"):$(".sup-med-wrapper").addClass("v-align"),width()<lg?$(".sup-size-wrapper").removeClass("v-align"):$(".sup-size-wrapper").addClass("v-align")})}
//function onOpened($e) {}
function onSelected(a,b){$("table.rx").not("#"+b).addClass("hidden"),$("table#"+b).removeClass("hidden"),checkboxResize(),a.target.blur()}function onAutocompleted(a,b){$("table.rx").not("#"+b).addClass("hidden"),$("table#"+b).removeClass("hidden"),checkboxResize(),a.target.blur()}// linearControls()
// Q.O.D.
function phaseQod(){$("[id$=_taper]").on("click",".phase-qod",function(a){a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),$(this).toggleClass("active");var b=$(this).children(),c=0==b.val()?"1":"0";b.val(c)})}/*--------------------------------------------------------------------------
  --------------------------------------------------------------------------
  *
  *                         Validation & Flow
  *
  --------------------------------------------------------------------------
---------------------------------------------------------------------------*/
/* validate user input
---------------------------------------------------------------------------*/
function isDays(a,b){var c=a.which?a.which:event.keyCode;return!(c<48||c>57)||8==c}function isDose(a,b){var c=a.which?a.which:event.keyCode;// “.” CHECK DOT, AND ONLY ONE.
return(46==c&&$(b).val().indexOf(".")==-1||!(c<48||c>57)||8==c)&&($(b).val().indexOf(".")==-1||!(53!=c||$(b).val().substring($(b).val().indexOf("."),$(b).val().indexOf(".").length).length>1)||8==c)}/*--------------------------------------------------------------------------
  --------------------------------------------------------------------------
  *
  *                            Phase Addition
  *
  --------------------------------------------------------------------------
---------------------------------------------------------------------------*/
/* remove controls from last phase and add controls to new phase
---------------------------------------------------------------------------*/
function newControls(a){var b=$(".non-linear .phase-add-delete"),c="slideInRight",d="slideOutRight";b.removeClass(c).addClass(d).one(animation_end,function(){$(this).removeClass(d)}).detach().appendTo(a).addClass(c)}!function(a,b,c){"use strict";var d=a.jQuery||a.Zepto||a.$,e=function(a,c){this.el=this.isString(a)?b.querySelectorAll(a):a,this.options=c,this.prefix="fl-",this.init()};e.prototype={defaults:{customEvent:null,customLabel:null,exclude:".no-label",inputRegex:/email|number|password|search|tel|text|url/,prioritize:"label",// label|placeholder
requiredClass:"required",style:0,// 0|1|2
transform:"input,select,textarea"},init:function(){var a=this;Array.prototype.forEach.call(this.el,function(b){a.config=a.extend({},a.defaults,a.options,b.getAttribute("data-options"));var c=a.sprintf(":not($0)",a.config.exclude.split(/[\s,]+/).join("):not("));a.on("reset",b,a.onReset.bind(a)),a.addClass(b,a.prefixed("form")),a.config.style&&a.addClass(b,a.prefixed("style-"+a.config.style)),a.config.transform.split(/[\s,]+/).forEach(function(d){b.querySelectorAll(d+c).forEach(function(c){a.floatLabel(b,c)})})})},floatLabel:function(a,b){if(b.getAttribute("id")&&!this.hasClass(b.parentNode,this.prefixed("wrap"))&&("INPUT"!==b.tagName||this.config.inputRegex.test(b.getAttribute("type")))){var c=this.getLabel(b,a);c&&(this.addClass(c,this.prefixed("label")),this.addClass(b,this.prefixed(b.tagName.toLowerCase())),this.setLabel(c,b),this.wrapLabel(c,b),this.runEvents(b))}},getLabel:function(a,b){var c=this.sprintf('label[for="$0"]',a.getAttribute("id")),d=b.querySelectorAll(c);
// check for multiple labels with identical 'for' attributes
return d.length>1&&(d=a.parentNode.querySelectorAll(c)),1===d.length&&d[0]},setLabel:function(a,b){var d=a.textContent.replace(/[*:]/g,"").trim(),e=b.getAttribute("placeholder");
// call the custom defined label event
if((!d||d&&e&&"placeholder"===this.config.prioritize)&&(d=e),"function"==typeof this.config.customLabel){var f=this.config.customLabel.call(this,a,b);f!==c&&(d=f)}a.text=d,
// add a placholder option to the select if it doesn't already exist
"SELECT"===b.tagName?""!==b.firstElementChild.value?b.insertBefore(new Option(d,"",(!0),(!0)),b.firstElementChild):""===b.firstElementChild.value&&""===b.options[0].text&&(b.firstElementChild.text=d):e&&"label"!==this.config.prioritize||b.setAttribute("placeholder",d)},wrapLabel:function(a,b){var c=this.createEl("div",{"class":this.prefixed("wrap")+" "+this.prefixed("wrap-"+b.tagName.toLowerCase())});b.value.length&&this.addClass(c,this.prefixed("is-active")),(null!==b.getAttribute("required")||this.hasClass(b,this.config.requiredClass))&&this.addClass(c,this.prefixed("is-required")),b.parentNode.insertBefore(c,b),c.appendChild(a),c.appendChild(b)},runEvents:function(a){
// call the custom defined event
"function"==typeof this.config.customEvent&&this.config.customEvent.call(this,a),
// events
this.on("blur",a,this.onBlur.bind(this)),this.on("input",a,this.onChange.bind(this)),this.on("focus",a,this.onFocus.bind(this))},onBlur:function(a){this.removeClass(a.target.parentNode,this.prefixed("has-focus"))},onChange:function(a){var b=a.target.value.length?"add":"remove";this[b+"Class"](a.target.parentNode,this.prefixed("is-active"))},onFocus:function(a){this.addClass(a.target.parentNode,this.prefixed("has-focus"))},onReset:function(a){var b=this;this.config.transform.split(/[\s,]+/).forEach(function(c){a.target.querySelectorAll(c).forEach(function(a){b.removeClass(a.parentNode,b.prefixed("is-active"))})})},addClass:function(a,b){a.classList?a.classList.add(b):this.hasClass(a,b)||(a.className+=" "+b)},hasClass:function(a,b){return a.classList?a.classList.contains(b):new RegExp("\\b"+b+"\\b").test(a.className)},removeClass:function(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("\\b"+b+"\\b","g"),"")},event:function(a,b,c,d){b.split(" ").forEach(function(b){c[a+"EventListener"](b,d,!1)})},on:function(a,b,c){this.event("add",a,b,c)},off:function(a,b,c){this.event("remove",a,b,c)},trigger:function(a,c){var d=b.createEvent("HTMLEvents");d.initEvent(a,!1,!0),c.dispatchEvent(d)},extend:function(){var a=[].slice.call(arguments),b=a[0],c=a.slice(1);return Object.keys(c).forEach(function(a){for(var d in c[a])c[a].hasOwnProperty(d)&&(b[d]=c[a][d])}),b},isString:function(a){return"[object String]"===Object.prototype.toString.call(a)},createEl:function(a,c){var d="string"==typeof a?b.createElement(a):a;c=c||{};for(var e in c)c.hasOwnProperty(e)&&d.setAttribute(e,c[e]);return d},prefixed:function(a){return this.prefix+a},sprintf:function(a){var b=[].slice.call(arguments,1,arguments.length);return a.replace(/\$(\d+)/g,function(a,d){return b[d]!==c?b[d]:a})}},e.defaults=e.prototype.defaults,a.FloatLabels=e,d&&(d.fn.floatlabels=function(a){d.data(this,"plugin_floatlabels")||d.data(this,"plugin_floatlabels",new e(this,a))})}(window,document),/*!
 * pickadate.js v3.5.6, 2015/04/20
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */
function(a){
// AMD.
"function"==typeof define&&define.amd?define("picker",["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):this.Picker=a(jQuery)}(function(a){/**
 * The picker constructor that creates a blank picker.
 */
function b(f,g,i,m){//PickerInstance.prototype
/**
     * Wrap the picker holder components together.
     */
function n(){
// Create a picker wrapper holder
// Create a picker wrapper node
// Create a picker frame
// Create a picker box node
// Create the components nodes.
// The picker box class
// Picker wrap class
// Picker frame class
// Picker holder class
return b._.node("div",b._.node("div",b._.node("div",b._.node("div",B.component.nodes(w.open),y.box),y.wrap),y.frame),y.holder,'tabindex="-1"')}//createWrappedComponent
/**
     * Prepare the input element with all bindings.
     */
function o(){z.data(g,B).addClass(y.input).val(z.data("value")?B.get("select",x.format):f.value),
// Only bind keydown events if the element isn’t editable.
x.editable||z.on("focus."+w.id+" click."+w.id,function(a){a.preventDefault(),B.open()}).on("keydown."+w.id,u),
// Update the aria attributes.
e(f,{haspopup:!0,expanded:!1,readonly:!1,owns:f.id+"_root"})}/**
     * Prepare the root picker element with all bindings.
     */
function p(){e(B.$root[0],"hidden",!0)}/**
      * Prepare the holder picker element with all bindings.
      */
function q(){B.$holder.on({
// For iOS8.
keydown:u,"focus.toOpen":t,blur:function(){
// Remove the “target” class.
z.removeClass(y.target)},
// When something within the holder is focused, stop from bubbling
// to the doc and remove the “focused” state from the root.
focusin:function(a){B.$root.removeClass(y.focused),a.stopPropagation()},
// When something within the holder is clicked, stop it
// from bubbling to the doc.
"mousedown click":function(b){var c=b.target;
// Make sure the target isn’t the root holder so it can bubble up.
c!=B.$holder[0]&&(b.stopPropagation(),
// * For mousedown events, cancel the default action in order to
//   prevent cases where focus is shifted onto external elements
//   when using things like jQuery mobile or MagnificPopup (ref: #249 & #120).
//   Also, for Firefox, don’t prevent action on the `option` element.
"mousedown"!=b.type||a(c).is("input, select, textarea, button, option")||(b.preventDefault(),
// Re-focus onto the holder so that users can click away
// from elements focused within the picker.
B.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var b=a(this),c=b.data(),d=b.hasClass(y.navDisabled)||b.hasClass(y.disabled),
// * For IE, non-focusable elements can be active elements as well
//   (http://stackoverflow.com/a/2684561).
e=h();e=e&&(e.type||e.href),
// If it’s disabled or nothing inside is actively focused, re-focus the element.
(d||e&&!a.contains(B.$root[0],e))&&B.$holder[0].focus(),
// If something is superficially changed, update the `highlight` based on the `nav`.
!d&&c.nav?B.set("highlight",B.component.item.highlight,{nav:c.nav}):!d&&"pick"in c?(B.set("select",c.pick),x.closeOnSelect&&B.close(!0)):c.clear?(B.clear(),x.closeOnClear&&B.close(!0)):c.close&&B.close(!0)})}/**
      * Prepare the hidden input element along with all bindings.
      */
function r(){var b;x.hiddenName===!0?(b=f.name,f.name=""):(b=["string"==typeof x.hiddenPrefix?x.hiddenPrefix:"","string"==typeof x.hiddenSuffix?x.hiddenSuffix:"_submit"],b=b[0]+f.name+b[1]),B._hidden=a('<input type=hidden name="'+b+'"'+(
// If the element has a value, set the hidden value as well.
z.data("value")||f.value?' value="'+B.get("select",x.formatSubmit)+'"':"")+">")[0],z.on("change."+w.id,function(){B._hidden.value=f.value?B.get("select",x.formatSubmit):""})}
// Wait for transitions to end before focusing the holder. Otherwise, while
// using the `container` option, the view jumps to the container.
function s(){v&&l?B.$holder.find("."+y.frame).one("transitionend",function(){B.$holder[0].focus()}):B.$holder[0].focus()}function t(a){
// Stop the event from propagating to the doc.
a.stopPropagation(),
// Add the “target” class.
z.addClass(y.target),
// Add the “focused” class to the root.
B.$root.addClass(y.focused),
// And then finally open the picker.
B.open()}
// For iOS8.
function u(a){var b=a.keyCode,
// Check if one of the delete keys was pressed.
c=/^(8|46)$/.test(b);
// For some reason IE clears the input value on “escape”.
// For some reason IE clears the input value on “escape”.
// Check if `space` or `delete` was pressed or the picker is closed with a key movement.
// Prevent it from moving the page and bubbling to doc.
// If `delete` was pressed, clear the values and close the picker.
// Otherwise open the picker.
return 27==b?(B.close(!0),!1):void((32==b||c||!w.open&&B.component.key[b])&&(a.preventDefault(),a.stopPropagation(),c?B.clear().close():B.open()))}
// If there’s no element, return the picker constructor.
if(!f)return b;var v=!1,
// The state of the picker.
w={id:f.id||"P"+Math.abs(~~(Math.random()*new Date))},
// Merge the defaults and options passed.
x=i?a.extend(!0,{},i.defaults,m):m||{},
// Merge the default classes with the settings classes.
y=a.extend({},b.klasses(),x.klass),
// The element node wrapper into a jQuery object.
z=a(f),
// Pseudo picker constructor.
A=function(){return this.start()},
// The picker prototype.
B=A.prototype={constructor:A,$node:z,/**
             * Initialize everything
             */
start:function(){
// If it’s already started, do nothing.
// If it’s already started, do nothing.
// Update the picker states.
// Confirm focus state, convert into text input to remove UA stylings,
// and set as readonly to prevent keyboard popup.
// Create a new picker component with the settings.
// Create the picker root and then prepare it.
// Create the picker holder and then prepare it.
// If there’s a format for the hidden input element, create the element.
// Prepare the input element.
// Insert the hidden input as specified in the settings.
// Insert the root as specified in the settings.
// Bind the default component and settings events.
// Once we’re all set, check the theme in use.
// If the element has autofocus, open the picker.
return w&&w.start?B:(w.methods={},w.start=!0,w.open=!1,w.type=f.type,f.autofocus=f==h(),f.readOnly=!x.editable,f.id=f.id||w.id,"text"!=f.type&&(f.type="text"),B.component=new i(B,x),B.$root=a('<div class="'+y.picker+'" id="'+f.id+'_root" />'),p(),B.$holder=a(n()).appendTo(B.$root),q(),x.formatSubmit&&r(),o(),x.containerHidden?a(x.containerHidden).append(B._hidden):z.after(B._hidden),x.container?a(x.container).append(B.$root):z.after(B.$root),B.on({start:B.component.onStart,render:B.component.onRender,stop:B.component.onStop,open:B.component.onOpen,close:B.component.onClose,set:B.component.onSet}).on({start:x.onStart,render:x.onRender,stop:x.onStop,open:x.onOpen,close:x.onClose,set:x.onSet}),v=c(B.$holder[0]),f.autofocus&&B.open(),B.trigger("start").trigger("render"))},//start
/**
             * Render a new picker
             */
render:function(b){
// Trigger the queued “render” events.
// Insert a new component holder in the root or box.
return b?(B.$holder=a(n()),q(),B.$root.html(B.$holder)):B.$root.find("."+y.box).html(B.component.nodes(w.open)),B.trigger("render")},//render
/**
             * Destroy everything
             */
stop:function(){
// If it’s already stopped, do nothing.
// If it’s already stopped, do nothing.
// Then close the picker.
// Remove the hidden field.
// Remove the root.
// Remove the input class, remove the stored data, and unbind
// the events (after a tick for IE - see `P.close`).
// Restore the element state
// Trigger the queued “stop” events.
// Reset the picker states.
return w.start?(B.close(),B._hidden&&B._hidden.parentNode.removeChild(B._hidden),B.$root.remove(),z.removeClass(y.input).removeData(g),setTimeout(function(){z.off("."+w.id)},0),f.type=w.type,f.readOnly=!1,B.trigger("stop"),w.methods={},w.start=!1,B):B},//stop
/**
             * Open up the picker
             */
open:function(c){
// If it’s already open, do nothing.
// If it’s already open, do nothing.
// Add the “active” class.
// * A Firefox bug, when `html` has `overflow:hidden`, results in
//   killing transitions :(. So add the “opened” state on the next tick.
//   Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=625289
// If we have to give focus, bind the element and doc events.
// Set it as open.
// Prevent the page from scrolling.
// Pass focus to the root element’s jQuery object.
// Bind the document events.
return w.open?B:(z.addClass(y.active),e(f,"expanded",!0),setTimeout(function(){
// Add the “opened” class to the picker root.
B.$root.addClass(y.opened),e(B.$root[0],"hidden",!1)},0),c!==!1&&(w.open=!0,v&&k.css("overflow","hidden").css("padding-right","+="+d()),s(),j.on("click."+w.id+" focusin."+w.id,function(a){var b=a.target;
// If the target of the event is not the element, close the picker picker.
// * Don’t worry about clicks or focusins on the root because those don’t bubble up.
//   Also, for Firefox, a click on an `option` element bubbles up directly
//   to the doc. So make sure the target wasn't the doc.
// * In Firefox stopPropagation() doesn’t prevent right-click events from bubbling,
//   which causes the picker to unexpectedly close when right-clicking it. So make
//   sure the event wasn’t a right-click.
b!=f&&b!=document&&3!=a.which&&
// If the target was the holder that covers the screen,
// keep the element focused to maintain tabindex.
B.close(b===B.$holder[0])}).on("keydown."+w.id,function(c){var
// Get the keycode.
d=c.keyCode,
// Translate that to a selection change.
e=B.component.key[d],
// Grab the target.
f=c.target;
// On escape, close the picker and give focus.
27==d?B.close(!0):f!=B.$holder[0]||!e&&13!=d?a.contains(B.$root[0],f)&&13==d&&(c.preventDefault(),f.click()):(
// Prevent the default action to stop page movement.
c.preventDefault(),
// Trigger the key movement action.
e?b._.trigger(B.component.key.go,B,[b._.trigger(e)]):B.$root.find("."+y.highlighted).hasClass(y.disabled)||(B.set("select",B.component.item.highlight),x.closeOnSelect&&B.close(!0)))})),B.trigger("open"))},//open
/**
             * Close the picker
             */
close:function(a){
// If it’s already closed, do nothing more.
// If we need to give focus, do it before changing states.
// ....ah yes! It would’ve been incomplete without a crazy workaround for IE :|
// The focus is triggered *after* the close has completed - causing it
// to open again. So unbind and rebind the event at the next tick.
// Remove the “active” class.
// * A Firefox bug, when `html` has `overflow:hidden`, results in
//   killing transitions :(. So remove the “opened” state on the next tick.
//   Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=625289
// If it’s already closed, do nothing more.
// Set it as closed.
// Allow the page to scroll.
// Unbind the document events.
return a&&(x.editable?f.focus():(B.$holder.off("focus.toOpen").focus(),setTimeout(function(){B.$holder.on("focus.toOpen",t)},0))),z.removeClass(y.active),e(f,"expanded",!1),setTimeout(function(){
// Remove the “opened” and “focused” class from the picker root.
B.$root.removeClass(y.opened+" "+y.focused),e(B.$root[0],"hidden",!0)},0),w.open?(w.open=!1,v&&k.css("overflow","").css("padding-right","-="+d()),j.off("."+w.id),B.trigger("close")):B},//close
/**
             * Clear the values
             */
clear:function(a){return B.set("clear",null,a)},//clear
/**
             * Set something
             */
set:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(
// Make sure we have usable options.
d=g&&a.isPlainObject(c)?c:d||{},b){
// If the thing isn’t an object, make it one.
g||(h[b]=c);
// Go through the things of items to set.
for(e in h)
// Grab the value of the thing.
f=h[e],
// First, if the item exists and there’s a value, set it.
e in B.component.item&&(void 0===f&&(f=null),B.component.set(e,f,d)),
// Then, check to update the element value and broadcast a change.
"select"!=e&&"clear"!=e||z.val("clear"==e?"":B.get(e,x.format)).trigger("change");
// Render a new picker.
B.render()}
// When the method isn’t muted, trigger queued “set” events and pass the `thingObject`.
return d.muted?B:B.trigger("set",h)},//set
/**
             * Get something
             */
get:function(a,c){
// If a picker state exists, return that.
if(
// Make sure there’s something to get.
a=a||"value",null!=w[a])return w[a];
// Return the submission value, if that.
if("valueSubmit"==a){if(B._hidden)return B._hidden.value;a="value"}
// Return the value, if that.
if("value"==a)return f.value;
// Check if a component item exists, return that.
if(a in B.component.item){if("string"==typeof c){var d=B.component.get(a);return d?b._.trigger(B.component.formats.toString,B.component,[c,d]):""}return B.component.get(a)}},//get
/**
             * Bind events on the things.
             */
on:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(b){
// If the thing isn’t an object, make it one.
g||(h[b]=c);
// Go through the things to bind to.
for(e in h)
// Grab the method of the thing.
f=h[e],
// If it was an internal binding, prefix it.
d&&(e="_"+e),
// Make sure the thing methods collection exists.
w.methods[e]=w.methods[e]||[],
// Add the method to the relative method collection.
w.methods[e].push(f)}return B},//on
/**
             * Unbind events on the things.
             */
off:function(){var a,b,c=arguments;for(a=0,namesCount=c.length;a<namesCount;a+=1)b=c[a],b in w.methods&&delete w.methods[b];return B},/**
             * Fire off method events.
             */
trigger:function(a,c){var d=function(a){var d=w.methods[a];d&&d.map(function(a){b._.trigger(a,B,[c])})};return d("_"+a),d(a),B}};
// Return a new picker instance.
return new A}//PickerConstructor.klasses
/**
 * Check if the default theme is being used.
 */
function c(a){var b,c="position";
// For IE.
return a.currentStyle?b=a.currentStyle[c]:window.getComputedStyle&&(b=getComputedStyle(a)[c]),"fixed"==b}/**
 * Get the width of the browser’s scrollbar.
 * Taken from: https://github.com/VodkaBears/Remodal/blob/master/src/jquery.remodal.js
 */
function d(){if(k.height()<=i.height())return 0;var b=a('<div style="visibility:hidden;width:100px" />').appendTo("body"),c=b[0].offsetWidth;
// Force adding scrollbars.
b.css("overflow","scroll");
// Add the inner div.
var d=a('<div style="width:100%" />').appendTo(b),e=d[0].offsetWidth;
// Return the difference between the widths.
// Remove the divs.
return b.remove(),c-e}//PickerConstructor.extend
function e(b,c,d){if(a.isPlainObject(c))for(var e in c)f(b,e,c[e]);else f(b,c,d)}function f(a,b,c){a.setAttribute(("role"==b?"":"aria-")+b,c)}function g(b,c){a.isPlainObject(b)||(b={attribute:c}),c="";for(var d in b){var e=("role"==d?"":"aria-")+d,f=b[d];c+=null==f?"":e+'="'+b[d]+'"'}return c}
// IE8 bug throws an error for activeElements within iframes.
function h(){try{return document.activeElement}catch(a){}}var i=a(window),j=a(document),k=a(document.documentElement),l=null!=document.documentElement.style.transition;
// Expose the picker constructor.
//PickerConstructor
/**
 * The default classes and prefix to use for the HTML classes.
 */
/**
 * PickerConstructor helper methods.
 */
//PickerConstructor._
/**
 * Extend the picker with a component and defaults.
 */
return b.klasses=function(a){return a=a||"picker",{picker:a,opened:a+"--opened",focused:a+"--focused",input:a+"__input",active:a+"__input--active",target:a+"__input--target",holder:a+"__holder",frame:a+"__frame",wrap:a+"__wrap",box:a+"__box"}},b._={/**
     * Create a group of nodes. Expects:
     * `
        {
            min:    {Integer},
            max:    {Integer},
            i:      {Integer},
            node:   {String},
            item:   {Function}
        }
     * `
     */
group:function(a){
// Loop from the `min` to `max`, incrementing by `i`
for(var
// Scope for the looped object
c,
// Create the nodes list
d="",
// The counter starts from the `min`
e=b._.trigger(a.min,a);e<=b._.trigger(a.max,a,[e]);e+=a.i)
// Trigger the `item` function within scope of the object
c=b._.trigger(a.item,a,[e]),
// Splice the subgroup and create nodes out of the sub nodes
d+=b._.node(a.node,c[0],// the node
c[1],// the classes
c[2]);
// Return the list of nodes
return d},//group
/**
     * Create a dom node string
     */
node:function(b,c,d,e){
// If the item is false-y, just return an empty string
// If the item is false-y, just return an empty string
// If the item is an array, do a join
// Check for the class
// Check for any attributes
return c?(c=a.isArray(c)?c.join(""):c,d=d?' class="'+d+'"':"",e=e?" "+e:"","<"+b+d+e+">"+c+"</"+b+">"):""},//node
/**
     * Lead numbers below 10 with a zero.
     */
lead:function(a){return(a<10?"0":"")+a},/**
     * Trigger a function otherwise return the value.
     */
trigger:function(a,b,c){return"function"==typeof a?a.apply(b,c||[]):a},/**
     * If the second character is a digit, length is 2 otherwise 1.
     */
digits:function(a){return/\d/.test(a[1])?2:1},/**
     * Tell if something is a date object.
     */
isDate:function(a){return{}.toString.call(a).indexOf("Date")>-1&&this.isInteger(a.getDate())},/**
     * Tell if something is an integer.
     */
isInteger:function(a){return{}.toString.call(a).indexOf("Number")>-1&&a%1===0},/**
     * Create ARIA attribute strings.
     */
ariaAttr:g},b.extend=function(c,d){
// Extend jQuery.
a.fn[c]=function(e,f){
// Grab the component data.
var g=this.data(c);
// If the picker is requested, return the data object.
// If the picker is requested, return the data object.
// If the component data exists and `options` is a string, carry out the action.
return"picker"==e?g:g&&"string"==typeof e?b._.trigger(g[e],g,[f]):this.each(function(){var f=a(this);f.data(c)||new b(this,c,d,e)})},
// Set the defaults.
a.fn[c].defaults=d.defaults},b}),/*!
 * Date picker for pickadate.js v3.5.6
 * http://amsul.github.io/pickadate.js/date.htm
 */
function(a){
// AMD.
"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){/**
 * The date picker constructor
 */
function c(a,b){var c=this,d=a.$node[0],e=d.value,f=a.$node.data("value"),g=f||e,h=f?b.formatSubmit:b.format,i=function(){
// For IE.
// For normal browsers.
return d.currentStyle?"rtl"==d.currentStyle.direction:"rtl"==getComputedStyle(a.$root[0]).direction};c.settings=b,c.$node=a.$node,
// The queue of methods that will be used to build item objects.
c.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},
// The component's item object.
c.item={},c.item.clear=null,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return a[0]===!0?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),
// When there’s a value, set the `select`, which in turn
// also sets the `highlight` and `view`.
g?c.set("select",g,{format:h,defaultValue:!0}):c.set("select",null).set("highlight",c.item.now),
// The keycode to movement mapping.
c.key={40:7,// Down
38:-7,// Up
39:function(){return i()?-1:1},// Right
37:function(){return i()?1:-1},// Left
go:function(a){var b=c.item.highlight,d=new Date(b.year,b.month,b.date+a);c.set("highlight",d,{interval:a}),this.render()}},
// Bind some picker events.
a.on("render",function(){a.$root.find("."+b.klass.selectMonth).on("change",function(){var c=this.value;c&&(a.set("highlight",[a.get("view").year,c,a.get("highlight").date]),a.$root.find("."+b.klass.selectMonth).trigger("focus"))}),a.$root.find("."+b.klass.selectYear).on("change",function(){var c=this.value;c&&(a.set("highlight",[c,a.get("view").month,a.get("highlight").date]),a.$root.find("."+b.klass.selectYear).trigger("focus"))})},1).on("open",function(){var d="";c.disabled(c.get("now"))&&(d=":not(."+b.klass.buttonToday+")"),a.$root.find("button"+d+", select").attr("disabled",!1)},1).on("close",function(){a.$root.find("button, select").attr("disabled",!0)},1)}/**
 * Globals and constants
 */
var d=7,e=6,f=a._;//DatePicker
/**
 * Set a datepicker item object.
 */
c.prototype.set=function(a,b,c){var d=this,e=d.item;
// If the value is `null` just set it immediately.
// If the value is `null` just set it immediately.
// Otherwise go through the queue of methods, and invoke the functions.
// Update this as the time unit, and set the final value as this item.
// * In the case of `enable`, keep the queue but set `disable` instead.
//   And in the case of `flip`, keep the queue but set `enable` instead.
// Check if we need to cascade through more updates.
return null===b?("clear"==a&&(a="select"),e[a]=b,d):(e["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"==a?d.set("highlight",e.select,c):"highlight"==a?d.set("view",e.highlight,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",e.select,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",e.highlight,c)),d)},//DatePicker.prototype.set
/**
 * Get a datepicker item object.
 */
c.prototype.get=function(a){return this.item[a]},//DatePicker.prototype.get
/**
 * Create a picker date object.
 */
c.prototype.create=function(a,c,d){var e,g=this;
// Return the compiled object.
// If there’s no value, use the type as the value.
// If it’s infinity, update the value.
return c=void 0===c?a:c,c==-(1/0)||c==1/0?e=c:b.isPlainObject(c)&&f.isInteger(c.pick)?c=c.obj:b.isArray(c)?(c=new Date(c[0],c[1],c[2]),c=f.isDate(c)?c:g.create().obj):c=f.isInteger(c)||f.isDate(c)?g.normalize(new Date(c),d):g.now(a,c,d),{year:e||c.getFullYear(),month:e||c.getMonth(),date:e||c.getDate(),day:e||c.getDay(),obj:e||c,pick:e||c.getTime()}},//DatePicker.prototype.create
/**
 * Create a range limit object using an array, date object,
 * literal “true”, or integer relative to another time.
 */
c.prototype.createRange=function(a,c){var d=this,e=function(a){return a===!0||b.isArray(a)||f.isDate(a)?d.create(a):a};
// Create objects if possible.
// Create relative dates.
return f.isInteger(a)||(a=e(a)),f.isInteger(c)||(c=e(c)),f.isInteger(a)&&b.isPlainObject(c)?a=[c.year,c.month,c.date+a]:f.isInteger(c)&&b.isPlainObject(a)&&(c=[a.year,a.month,a.date+c]),{from:e(a),to:e(c)}},//DatePicker.prototype.createRange
/**
 * Check if a date unit falls within a date range object.
 */
c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},/**
 * Check if two date range objects overlap.
 */
c.prototype.overlapRanges=function(a,b){var c=this;
// Convert the ranges into comparable dates.
return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},/**
 * Get the date today.
 */
c.prototype.now=function(a,b,c){return b=new Date,c&&c.rel&&b.setDate(b.getDate()+c.rel),this.normalize(b,c)},/**
 * Navigate to next/prev month.
 */
c.prototype.navigate=function(a,c,d){var e,f,g,h,i=b.isArray(c),j=b.isPlainObject(c),k=this.item.view;/*,
        safety = 100*/
if(i||j){
// If the month we’re going to doesn’t have enough days,
// keep decreasing the date until we reach the month’s last date.
for(j?(f=c.year,g=c.month,h=c.date):(f=+c[0],g=+c[1],h=+c[2]),
// If we’re navigating months but the view is in a different
// month, navigate to the view’s year and month.
d&&d.nav&&k&&k.month!==g&&(f=k.year,g=k.month),
// Figure out the expected target year and month.
e=new Date(f,g+(d&&d.nav?d.nav:0),1),f=e.getFullYear(),g=e.getMonth();/*safety &&*/new Date(f,g,h).getMonth()!==g;)h-=1;c=[f,g,h]}return c},//DatePicker.prototype.navigate
/**
 * Normalize a date by setting the hours to midnight.
 */
c.prototype.normalize=function(a){return a.setHours(0,0,0,0),a},/**
 * Measure the range of dates.
 */
c.prototype.measure=function(a,b){var c=this;
// If it’s anything false-y, remove the limits.
return b?"string"==typeof b?b=c.parse(a,b):f.isInteger(b)&&(b=c.now(a,b,{rel:b})):b="min"==a?-(1/0):1/0,b},///DatePicker.prototype.measure
/**
 * Create a viewset object based on navigation.
 */
c.prototype.viewset=function(a,b){return this.create([b.year,b.month,1])},/**
 * Validate a date as enabled and shift if needed.
 */
c.prototype.validate=function(a,c,d){var
// Check if we have any enabled dates after/before now.
e,g,
// Check if we’ve reached the limit during shifting.
h,i,j=this,
// Keep a reference to the original date.
k=c,
// Make sure we have an interval.
l=d&&d.interval?d.interval:1,
// Check if the calendar enabled dates are inverted.
m=j.item.enable===-1,
// The min & max limits.
n=j.item.min,o=j.item.max,
// Check if the calendar is inverted and at least one weekday is enabled.
p=m&&j.item.disable.filter(function(a){
// If there’s a date, check where it is relative to the target.
if(b.isArray(a)){var d=j.create(a).pick;d<c.pick?e=!0:d>c.pick&&(g=!0)}
// Return only integers for enabled weekdays.
return f.isInteger(a)}).length;/*,

        safety = 100*/
// Cases to validate for:
// [1] Not inverted and date disabled.
// [2] Inverted and some dates enabled.
// [3] Not inverted and out of range.
//
// Cases to **not** validate for:
// • Navigating months.
// • Not inverted and date enabled.
// • Inverted and all dates disabled.
// • ..and anything else.
if((!d||!d.nav&&!d.defaultValue)&&(/* 1 */
!m&&j.disabled(c)||/* 2 */
m&&j.disabled(c)&&(p||e||g)||/* 3 */
!m&&(c.pick<=n.pick||c.pick>=o.pick)))
// Keep looping until we reach an enabled date.
for(
// When inverted, flip the direction if there aren’t any enabled weekdays
// and there are no enabled dates in the direction of the interval.
m&&!p&&(!g&&l>0||!e&&l<0)&&(l*=-1);/*safety &&*/j.disabled(c)&&(/*safety -= 1
            if ( !safety ) {
                throw 'Fell into an infinite loop while validating ' + dateObject.obj + '.'
            }*/
// If we’ve looped into the next/prev month with a large interval, return to the original date and flatten the interval.
Math.abs(l)>1&&(c.month<k.month||c.month>k.month)&&(c=k,l=l>0?1:-1),
// If we’ve reached the min/max limit, reverse the direction, flatten the interval and set it to the limit.
c.pick<=n.pick?(h=!0,l=1,c=j.create([n.year,n.month,n.date+(c.pick===n.pick?0:-1)])):c.pick>=o.pick&&(i=!0,l=-1,c=j.create([o.year,o.month,o.date+(c.pick===o.pick?0:1)])),!h||!i);)
// Finally, create the shifted date using the interval and keep looping.
c=j.create([c.year,c.month,c.date+l]);//endif
// Return the date object settled on.
return c},//DatePicker.prototype.validate
/**
 * Check if a date is disabled.
 */
c.prototype.disabled=function(a){var c=this,
// Filter through the disabled dates to check if this is one.
d=c.item.disable.filter(function(d){
// If the date is a number, match the weekday with 0index and `firstDay` check.
// If the date is a number, match the weekday with 0index and `firstDay` check.
// If it’s an array or a native JS date, create and match the exact date.
// If it’s an object, match a date within the “from” and “to” range.
return f.isInteger(d)?a.day===(c.settings.firstDay?d:d-1)%7:b.isArray(d)||f.isDate(d)?a.pick===c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});
// Check the calendar “enabled” flag and respectively flip the
// disabled state. Then also check if it’s beyond the min/max limits.
// If this date matches a disabled date, confirm it’s not inverted.
return d=d.length&&!d.filter(function(a){return b.isArray(a)&&"inverted"==a[3]||b.isPlainObject(a)&&a.inverted}).length,c.item.enable===-1?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},//DatePicker.prototype.disabled
/**
 * Parse a string into a usable type.
 */
c.prototype.parse=function(a,b,c){var d=this,e={};
// If it’s already parsed, we’re good.
// If it’s already parsed, we’re good.
// We need a `.format` to parse the value with.
// Convert the format into an array and then map through it.
return b&&"string"==typeof b?(c&&c.format||(c=c||{},c.format=d.settings.format),d.formats.toArray(c.format).map(function(a){var
// Grab the formatting label.
c=d.formats[a],
// The format length is from the formatting label function or the
// label length without the escaping exclamation (!) mark.
g=c?f.trigger(c,d,[b,e]):a.replace(/^!/,"").length;
// If there's a format label, split the value up to the format length.
// Then add it to the parsing object with appropriate label.
c&&(e[a]=b.substr(0,g)),
// Update the value as the substring from format length to end.
b=b.substr(g)}),[e.yyyy||e.yy,+(e.mm||e.m)-1,e.dd||e.d]):b},//DatePicker.prototype.parse
/**
 * Various formats to display the object in.
 */
c.prototype.formats=function(){
// Return the length of the first word in a collection.
function a(a,b,c){
// Grab the first word from the string.
// Regex pattern from http://stackoverflow.com/q/150033
var d=a.match(/[^\x00-\x7F]+|\w+/)[0];
// Return the length of the word.
// If there's no month index, add it to the date object
return c.mm||c.m||(c.m=b.indexOf(d)+1),d.length}
// Get the length of the first word in a string.
function b(a){return a.match(/\w+/)[0].length}return{d:function(a,b){
// If there's string, then get the digits length.
// Otherwise return the selected date.
return a?f.digits(a):b.date},dd:function(a,b){
// If there's a string, then the length is always 2.
// Otherwise return the selected date with a leading zero.
return a?2:f.lead(b.date)},ddd:function(a,c){
// If there's a string, then get the length of the first word.
// Otherwise return the short selected weekday.
return a?b(a):this.settings.weekdaysShort[c.day]},dddd:function(a,c){
// If there's a string, then get the length of the first word.
// Otherwise return the full selected weekday.
return a?b(a):this.settings.weekdaysFull[c.day]},m:function(a,b){
// If there's a string, then get the length of the digits
// Otherwise return the selected month with 0index compensation.
return a?f.digits(a):b.month+1},mm:function(a,b){
// If there's a string, then the length is always 2.
// Otherwise return the selected month with 0index and leading zero.
return a?2:f.lead(b.month+1)},mmm:function(b,c){var d=this.settings.monthsShort;
// If there's a string, get length of the relevant month from the short
// months collection. Otherwise return the selected month from that collection.
return b?a(b,d,c):d[c.month]},mmmm:function(b,c){var d=this.settings.monthsFull;
// If there's a string, get length of the relevant month from the full
// months collection. Otherwise return the selected month from that collection.
return b?a(b,d,c):d[c.month]},yy:function(a,b){
// If there's a string, then the length is always 2.
// Otherwise return the selected year by slicing out the first 2 digits.
return a?2:(""+b.year).slice(2)},yyyy:function(a,b){
// If there's a string, then the length is always 4.
// Otherwise return the selected year.
return a?4:b.year},
// Create an array by splitting the formatting string passed.
toArray:function(a){return a.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},
// Format an object into a string using the formatting options.
toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return f.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}}}(),//DatePicker.prototype.formats
/**
 * Check if two date units are the exact.
 */
c.prototype.isDateExact=function(a,c){var d=this;
// When we’re working with weekdays, do a direct comparison.
// When we’re working with weekdays, do a direct comparison.
// When we’re working with date representations, compare the “pick” value.
// When we’re working with range objects, compare the “from” and “to”.
return f.isInteger(a)&&f.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(f.isDate(a)||b.isArray(a))&&(f.isDate(c)||b.isArray(c))?d.create(a).pick===d.create(c).pick:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&(d.isDateExact(a.from,c.from)&&d.isDateExact(a.to,c.to))},/**
 * Check if two date units overlap.
 */
c.prototype.isDateOverlap=function(a,c){var d=this,e=d.settings.firstDay?1:0;
// When we’re working with a weekday index, compare the days.
// When we’re working with a weekday index, compare the days.
// When we’re working with range objects, check if the ranges overlap.
return f.isInteger(a)&&(f.isDate(c)||b.isArray(c))?(a=a%7+e,a===d.create(c).day+1):f.isInteger(c)&&(f.isDate(a)||b.isArray(a))?(c=c%7+e,c===d.create(a).day+1):!(!b.isPlainObject(a)||!b.isPlainObject(c))&&d.overlapRanges(a,c)},/**
 * Flip the “enabled” state.
 */
c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(b.enable==-1?1:-1)},/**
 * Mark a collection of dates as “disabled”.
 */
c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);
// Return the updated collection.
// If we’re flipping, that’s all we need to do.
return"flip"==c?d.flipEnable():c===!1?(d.flipEnable(1),e=[]):c===!0?(d.flipEnable(-1),e=[]):c.map(function(a){
// When we have disabled items, check for matches.
// If something is matched, immediately break out.
for(var c,g=0;g<e.length;g+=1)if(d.isDateExact(a,e[g])){c=!0;break}
// If nothing was found, add the validated unit to the collection.
c||(f.isInteger(a)||f.isDate(a)||b.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},//DatePicker.prototype.deactivate
/**
 * Mark a collection of dates as “enabled”.
 */
c.prototype.activate=function(a,c){var d=this,e=d.item.disable,g=e.length;
// Return the updated collection.
// If we’re flipping, that’s all we need to do.
return"flip"==c?d.flipEnable():c===!0?(d.flipEnable(1),e=[]):c===!1?(d.flipEnable(-1),e=[]):c.map(function(a){var c,h,i,j;
// Go through the disabled items and try to find a match.
for(i=0;i<g;i+=1){
// When an exact match is found, remove it from the collection.
if(h=e[i],d.isDateExact(h,a)){c=e[i]=null,j=!0;break}if(d.isDateOverlap(h,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):b.isArray(a)?(c=a,c[3]||c.push("inverted")):f.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}
// If a match was found, remove a previous duplicate entry.
if(c)for(i=0;i<g;i+=1)if(d.isDateExact(e[i],a)){e[i]=null;break}
// In the event that we’re dealing with an exact range of dates,
// make sure there are no “inverted” dates because of it.
if(j)for(i=0;i<g;i+=1)if(d.isDateOverlap(e[i],a)){e[i]=null;break}
// If something is still matched, add it into the collection.
c&&e.push(c)}),e.filter(function(a){return null!=a})},//DatePicker.prototype.activate
/**
 * Create a string for the nodes in the picker.
 */
c.prototype.nodes=function(a){var b=this,c=b.settings,g=b.item,h=g.now,i=g.select,j=g.highlight,k=g.view,l=g.disable,m=g.min,n=g.max,
// Create the calendar table head using a copy of weekday labels collection.
// * We do a copy so we don't mutate the original array.
o=function(a,b){
// Create and return the table head group.
// If the first day should be Monday, move Sunday to the end.
return c.firstDay&&(a.push(a.shift()),b.push(b.shift())),f.node("thead",f.node("tr",f.group({min:0,max:d-1,i:1,node:"th",item:function(d){return[a[d],c.klass.weekdays,'scope=col title="'+b[d]+'"']}})))}((c.showWeekdaysFull?c.weekdaysFull:c.weekdaysShort).slice(0),c.weekdaysFull.slice(0)),//tableHead
// Create the nav for next/prev month.
p=function(a){
// Otherwise, return the created month tag.
// If the focused month is outside the range, disabled the button.
return f.node("div"," ",c.klass["nav"+(a?"Next":"Prev")]+(a&&k.year>=n.year&&k.month>=n.month||!a&&k.year<=m.year&&k.month<=m.month?" "+c.klass.navDisabled:""),"data-nav="+(a||-1)+" "+f.ariaAttr({role:"button",controls:b.$node[0].id+"_table"})+' title="'+(a?c.labelMonthNext:c.labelMonthPrev)+'"')},//createMonthNav
// Create the month label.
q=function(){var d=c.showMonthsShort?c.monthsShort:c.monthsFull;
// If there are months to select, add a dropdown menu.
// If there are months to select, add a dropdown menu.
return c.selectMonths?f.node("select",f.group({min:0,max:11,i:1,node:"option",item:function(a){return[
// The looped month and no classes.
d[a],0,
// Set the value and selected index.
"value="+a+(k.month==a?" selected":"")+(k.year==m.year&&a<m.month||k.year==n.year&&a>n.month?" disabled":"")]}}),c.klass.selectMonth,(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelMonthSelect+'"'):f.node("div",d[k.month],c.klass.month)},//createMonthLabel
// Create the year label.
r=function(){var d=k.year,
// If years selector is set to a literal "true", set it to 5. Otherwise
// divide in half to get half before and half after focused year.
e=c.selectYears===!0?5:~~(c.selectYears/2);
// If there are years to select, add a dropdown menu.
if(e){var g=m.year,h=n.year,i=d-e,j=d+e;
// If the max year is less than the highest year, decrease the lowest year
// by the lower of the two: available and needed years. Then set the
// highest year to the max year.
if(
// If the min year is greater than the lowest year, increase the highest year
// by the difference and set the lowest year to the min year.
g>i&&(j+=g-i,i=g),h<j){var l=i-g,o=j-h;i-=l>o?o:l,j=h}return f.node("select",f.group({min:i,max:j,i:1,node:"option",item:function(a){return[
// The looped year and no classes.
a,0,
// Set the value and selected index.
"value="+a+(d==a?" selected":"")]}}),c.klass.selectYear,(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelYearSelect+'"')}
// Otherwise just return the year focused
return f.node("div",d,c.klass.year)};//createYearLabel
// Create and return the entire calendar.
// * For Firefox forms to submit, make sure to set the buttons’ `type` attributes as “button”.
return f.node("div",(c.selectYears?r()+q():q()+r())+p()+p(1),c.klass.header)+f.node("table",o+f.node("tbody",f.group({min:0,max:e-1,i:1,node:"tr",item:function(a){
// If Monday is the first day and the month starts on Sunday, shift the date back a week.
var e=c.firstDay&&0===b.create([k.year,k.month,1]).day?-7:0;return[f.group({min:d*a-k.day+e+1,// Add 1 for weekday 0index
max:function(){return this.min+d-1},i:1,node:"td",item:function(a){
// Convert the time date from a relative date to a target date.
a=b.create([k.year,k.month,a+(c.firstDay?1:0)]);var d=i&&i.pick==a.pick,e=j&&j.pick==a.pick,g=l&&b.disabled(a)||a.pick<m.pick||a.pick>n.pick,o=f.trigger(b.formats.toString,b,[c.format,a]);return[f.node("div",a.date,function(b){
// Add the `infocus` or `outfocus` classes based on month in view.
// Add the `today` class if needed.
// Add the `selected` class if something's selected and the time matches.
// Add the `highlighted` class if something's highlighted and the time matches.
// Add the `disabled` class if something's disabled and the object matches.
return b.push(k.month==a.month?c.klass.infocus:c.klass.outfocus),h.pick==a.pick&&b.push(c.klass.now),d&&b.push(c.klass.selected),e&&b.push(c.klass.highlighted),g&&b.push(c.klass.disabled),b.join(" ")}([c.klass.day]),"data-pick="+a.pick+" "+f.ariaAttr({role:"gridcell",label:o,selected:!(!d||b.$node.val()!==o)||null,activedescendant:!!e||null,disabled:!!g||null})),"",f.ariaAttr({role:"presentation"})]}})]}})),c.klass.table,'id="'+b.$node[0].id+'_table" '+f.ariaAttr({role:"grid",controls:b.$node[0].id,readonly:!0}))+f.node("div",f.node("button",c.today,c.klass.buttonToday,"type=button data-pick="+h.pick+(a&&!b.disabled(h)?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.clear,c.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.close,c.klass.buttonClose,"type=button data-close=true "+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id})),c.klass.footer)},//DatePicker.prototype.nodes
/**
 * The date picker defaults.
 */
c.defaults=function(a){return{
// The title label to use for the month nav buttons
labelMonthNext:"Next month",labelMonthPrev:"Previous month",
// The title label to use for the dropdown selectors
labelMonthSelect:"Select a month",labelYearSelect:"Select a year",
// Months and weekdays
monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],
// Today and clear
today:"Today",clear:"Clear",close:"Close",
// Picker close behavior
closeOnSelect:!0,closeOnClear:!0,
// The format to show on the `input` element
format:"d mmmm, yyyy",
// Classes
klass:{table:a+"table",header:a+"header",navPrev:a+"nav--prev",navNext:a+"nav--next",navDisabled:a+"nav--disabled",month:a+"month",year:a+"year",selectMonth:a+"select--month",selectYear:a+"select--year",weekdays:a+"weekday",day:a+"day",disabled:a+"day--disabled",selected:a+"day--selected",highlighted:a+"day--highlighted",now:a+"day--today",infocus:a+"day--infocus",outfocus:a+"day--outfocus",footer:a+"footer",buttonClear:a+"button--clear",buttonToday:a+"button--today",buttonClose:a+"button--close"}}}(a.klasses().picker+"__"),/**
 * Extend the picker to add the date picker.
 */
a.extend("pickadate",c)}),/*!
 * iCheck v1.0.2, http://git.io/arlzeA
 * ===================================
 * Powerful jQuery and Zepto plugin for checkboxes and radio buttons customization
 *
 * (c) 2013 Damir Sultanov, http://fronteed.com
 * MIT Licensed
 */
function(a){
// Do something with inputs
function b(a,b,e){var f=a[0],g=/er/.test(e)?_indeterminate:/bl/.test(e)?o:m,h=e==_update?{checked:f[m],disabled:f[o],indeterminate:"true"==a.attr(_indeterminate)||"false"==a.attr(_determinate)}:f[g];
// Check, disable or indeterminate
if(/^(ch|di|in)/.test(e)&&!h)c(a,g);else if(/^(un|en|de)/.test(e)&&h)d(a,g);else if(e==_update)
// Handle states
for(var i in h)h[i]?c(a,i,!0):d(a,i,!0);else b&&"toggle"!=e||(
// Helper or label was clicked
b||a[_callback]("ifClicked"),
// Toggle checked state
h?f[_type]!==l&&d(a,g):c(a,g))}
// Add checked, disabled or indeterminate state
function c(b,c,e){var k=b[0],p=b.parent(),q=c==m,r=c==_indeterminate,s=c==o,t=r?_determinate:q?n:"enabled",u=f(b,t+g(k[_type])),v=f(b,c+g(k[_type]));
// Prevent unnecessary actions
if(k[c]!==!0){
// Toggle assigned radio buttons
if(!e&&c==m&&k[_type]==l&&k.name){var w=b.closest("form"),x='input[name="'+k.name+'"]';x=w.length?w.find(x):a(x),x.each(function(){this!==k&&a(this).data(i)&&d(a(this),c)})}
// Indeterminate state
r?(
// Add indeterminate state
k[c]=!0,
// Remove checked state
k[m]&&d(b,m,"force")):(
// Add checked or disabled state
e||(k[c]=!0),
// Remove indeterminate state
q&&k[_indeterminate]&&d(b,_indeterminate,!1)),
// Trigger callbacks
h(b,q,c,e)}
// Add proper cursor
k[o]&&f(b,_cursor,!0)&&p.find("."+j).css(_cursor,"default"),
// Add state class
p[_add](v||f(b,c)||""),
// Set ARIA attribute
p.attr("role")&&!r&&p.attr("aria-"+(s?o:m),"true"),
// Remove regular state class
p[_remove](u||f(b,t)||"")}
// Remove checked, disabled or indeterminate state
function d(a,b,c){var d=a[0],e=a.parent(),i=b==m,k=b==_indeterminate,l=b==o,p=k?_determinate:i?n:"enabled",q=f(a,p+g(d[_type])),r=f(a,b+g(d[_type]));
// Prevent unnecessary actions
d[b]!==!1&&(
// Toggle state
!k&&c&&"force"!=c||(d[b]=!1),
// Trigger callbacks
h(a,i,p,c)),
// Add proper cursor
!d[o]&&f(a,_cursor,!0)&&e.find("."+j).css(_cursor,"pointer"),
// Remove state class
e[_remove](r||f(a,b)||""),
// Set ARIA attribute
e.attr("role")&&!k&&e.attr("aria-"+(l?o:m),"false"),
// Add regular state class
e[_add](q||f(a,p)||"")}
// Remove all traces
function e(b,c){b.data(i)&&(
// Remove everything except input
b.parent().html(b.attr("style",b.data(i).s||"")),
// Callback
c&&b[_callback](c),
// Unbind events
b.off(".i").unwrap(),a(_label+'[for="'+b[0].id+'"]').add(b.closest(_label)).off(".i"))}
// Get some option
function f(a,b,c){if(a.data(i))return a.data(i).o[b+(c?"":"Class")]}
// Capitalize some string
function g(a){return a.charAt(0).toUpperCase()+a.slice(1)}
// Executable handlers
function h(a,b,c,d){d||(b&&a[_callback]("ifToggled"),a[_callback]("ifChanged")[_callback]("if"+g(c)))}
// Cached vars
var i="iCheck",j=i+"-helper",k="checkbox",l="radio",m="checked",n="un"+m,o="disabled";_determinate="determinate",_indeterminate="in"+_determinate,_update="update",_type="type",_click="click",_touch="touchbegin.i touchend.i",_add="addClass",_remove="removeClass",_callback="trigger",_label="label",_cursor="cursor",_mobile=/ipad|iphone|ipod|android|blackberry|windows phone|opera mini|silk/i.test(navigator.userAgent),
// Plugin init
a.fn[i]=function(f,g){
// Walker
var h='input[type="'+k+'"], input[type="'+l+'"]',n=a(),p=function(b){b.each(function(){var b=a(this);n=b.is(h)?n.add(b):n.add(b.find(h))})};
// Check if we should operate with some method
if(/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(f))
// Normalize method's name
// Find checkboxes and radio buttons
return f=f.toLowerCase(),p(this),n.each(function(){var c=a(this);"destroy"==f?e(c,"ifDestroyed"):b(c,!0,f),
// Fire method's callback
a.isFunction(g)&&g()});if("object"!=typeof f&&f)return this;
// Check if any options were passed
var q=a.extend({checkedClass:m,disabledClass:o,indeterminateClass:_indeterminate,labelHover:!0},f),r=q.handle,s=q.hoverClass||"hover",t=q.focusClass||"focus",u=q.activeClass||"active",v=!!q.labelHover,w=q.labelHoverClass||"hover",
// Setup clickable area
x=0|(""+q.increaseArea).replace("%","");
// Selector limit
// Clickable area limit
// Walk around the selector
return r!=k&&r!=l||(h='input[type="'+r+'"]'),x<-50&&(x=-50),p(this),n.each(function(){var f=a(this);
// If already customized
e(f);var g,h=this,n=h.id,
// Layer styles
p=-x+"%",r=100+2*x+"%",y={position:"absolute",top:p,left:p,display:"block",width:r,height:r,margin:0,padding:0,background:"#fff",border:0,opacity:0},
// Choose how to hide input
z=_mobile?{position:"absolute",visibility:"hidden"}:x?y:{position:"absolute",opacity:0},
// Get proper class
A=h[_type]==k?q.checkboxClass||"i"+k:q.radioClass||"i"+l,
// Find assigned labels
B=a(_label+'[for="'+n+'"]').add(f.closest(_label)),
// Check ARIA option
C=!!q.aria,
// Set ARIA placeholder
D=i+"-"+Math.random().toString(36).substr(2,6),
// Parent & helper
E='<div class="'+A+'" '+(C?'role="'+h[_type]+'" ':"");
// Set ARIA "labelledby"
C&&B.each(function(){E+='aria-labelledby="',this.id?E+=this.id:(this.id=D,E+=D),E+='"'}),
// Wrap input
E=f.wrap(E+"/>")[_callback]("ifCreated").parent().append(q.insert),
// Layer addition
g=a('<ins class="'+j+'"/>').css(y).appendTo(E),
// Finalize customization
f.data(i,{o:q,s:f.attr("style")}).css(z),!!q.inheritClass&&E[_add](h.className||""),!!q.inheritID&&n&&E.attr("id",i+"-"+n),"static"==E.css("position")&&E.css("position","relative"),b(f,!0,_update),
// Label events
B.length&&B.on(_click+".i mouseover.i mouseout.i "+_touch,function(c){var d=c[_type],e=a(this);
// Do nothing if input is disabled
if(!h[o]){
// Click
if(d==_click){if(a(c.target).is("a"))return;b(f,!1,!0)}else v&&(
// mouseout|touchend
/ut|nd/.test(d)?(E[_remove](s),e[_remove](w)):(E[_add](s),e[_add](w)));if(!_mobile)return!1;c.stopPropagation()}}),
// Input events
f.on(_click+".i focus.i blur.i keyup.i keydown.i keypress.i",function(a){var b=a[_type],e=a.keyCode;
// Click
// Click
return b!=_click&&("keydown"==b&&32==e?(h[_type]==l&&h[m]||(h[m]?d(f,m):c(f,m)),!1):void("keyup"==b&&h[_type]==l?!h[m]&&c(f,m):/us|ur/.test(b)&&E["blur"==b?_remove:_add](t)))}),
// Helper events
g.on(_click+" mousedown mouseup mouseover mouseout "+_touch,function(a){var c=a[_type],
// mousedown|mouseup
d=/wn|up/.test(c)?u:s;
// Do nothing if input is disabled
if(!h[o]){if(
// Click
c==_click?b(f,!1,!0):(
// State is on
/wn|er|in/.test(c)?
// mousedown|mouseover|touchbegin
E[_add](d):E[_remove](d+" "+u),
// Label hover
B.length&&v&&d==s&&
// mouseout|touchend
B[/ut|nd/.test(c)?_remove:_add](w)),!_mobile)return!1;a.stopPropagation()}})})}}(window.jQuery||window.Zepto),/*!
 * typeahead.js 0.11.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
 */
function(a,b){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(a){return b(a)}):"object"==typeof exports?module.exports=b(require("jquery")):b(jQuery)}(this,function(a){var b=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(b){return b instanceof a},toStr:function(a){return b.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){if(!(d=c.call(null,e,a,b)))return!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){if(d=c.call(null,e,a,b))return!1}),!!d):d},mixin:a.extend,identity:function(a){return a},clone:function(b){return a.extend(!0,{},b)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,j<=0?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},stringify:function(a){return b.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),c=function(){"use strict";function a(a){var g,h;return h=b.mixin({},f,a),g={css:e(),classes:h,html:c(h),selectors:d(h)},{css:g.css,html:g.html,classes:g.classes,selectors:g.selectors,mixin:function(a){b.mixin(a,g)}}}function c(a){return{wrapper:'<span class="'+a.wrapper+'"></span>',menu:'<div class="'+a.menu+'"></div>'}}function d(a){var c={};return b.each(a,function(a,b){c[b]="."+a}),c}function e(){var a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return b.isMsie()&&b.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),a}var f={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return a}(),d=function(){"use strict";function c(b){b&&b.el||a.error("EventBus initialized without el"),this.$el=a(b.el)}var d,e;return d="typeahead:",e={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},b.mixin(c.prototype,{_trigger:function(b,c){var e;return e=a.Event(d+b),(c=c||[]).unshift(e),this.$el.trigger.apply(this.$el,c),e},before:function(a){var b,c;return b=[].slice.call(arguments,1),c=this._trigger("before"+a,b),c.isDefaultPrevented()},trigger:function(a){var b;this._trigger(a,[].slice.call(arguments,1)),(b=e[a])&&this._trigger(b,[].slice.call(arguments,1))}}),c}(),e=function(){"use strict";function a(a,b,c,d){var e;if(!c)return this;for(b=b.split(i),c=d?h(c,d):c,this._callbacks=this._callbacks||{};e=b.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(c);return this}function b(b,c,d){return a.call(this,"async",b,c,d)}function c(b,c,d){return a.call(this,"sync",b,c,d)}function d(a){var b;if(!this._callbacks)return this;for(a=a.split(i);b=a.shift();)delete this._callbacks[b];return this}function e(a){var b,c,d,e,g;if(!this._callbacks)return this;for(a=a.split(i),d=[].slice.call(arguments,1);(b=a.shift())&&(c=this._callbacks[b]);)e=f(c.sync,this,[b].concat(d)),g=f(c.async,this,[b].concat(d)),e()&&j(g);return this}function f(a,b,c){function d(){for(var d,e=0,f=a.length;!d&&e<f;e+=1)d=a[e].apply(b,c)===!1;return!d}return d}function g(){var a;return a=window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}function h(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var i=/\s+/,j=g();return{onSync:c,onAsync:b,off:d,trigger:e}}(),f=function(a){"use strict";function c(a,c,d){for(var e,f=[],g=0,h=a.length;g<h;g++)f.push(b.escapeRegExChars(a[g]));return e=d?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")",c?new RegExp(e):new RegExp(e,"i")}var d={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(e){function f(b){var c,d,f;return(c=h.exec(b.data))&&(f=a.createElement(e.tagName),e.className&&(f.className=e.className),d=b.splitText(c.index),d.splitText(c[0].length),f.appendChild(d.cloneNode(!0)),b.parentNode.replaceChild(f,d)),!!c}function g(a,b){for(var c,d=3,e=0;e<a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===d?e+=b(c)?1:0:g(c,b)}var h;e=b.mixin({},d,e),e.node&&e.pattern&&(e.pattern=b.isArray(e.pattern)?e.pattern:[e.pattern],h=c(e.pattern,e.caseSensitive,e.wordsOnly),g(e.node,f))}}(window.document),g=function(){"use strict";function c(c,e){c=c||{},c.input||a.error("input is missing"),e.mixin(this),this.$hint=a(c.hint),this.$input=a(c.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=d(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=b.noop)}function d(b){return a('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b)}function f(a,b){return c.normalizeQuery(a)===c.normalizeQuery(b)}function g(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var h;return h={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},c.normalizeQuery=function(a){return b.toStr(a).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(c.prototype,e,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(a){var b=h[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(a,b){var c;switch(a){case"up":case"down":c=!g(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!g(b);break;default:c=!0}return c},_checkLanguageDirection:function(){var a=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==a&&(this.dir=a,this.$hint.attr("dir",a),this.trigger("langDirChanged",a))},_setQuery:function(a,b){var c,d;c=f(a,this.query),d=!!c&&this.query.length!==a.length,this.query=a,b||c?!b&&d&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var a,c,d,e,f=this;return a=b.bind(this._onBlur,this),c=b.bind(this._onFocus,this),d=b.bind(this._onKeydown,this),e=b.bind(this._onInput,this),this.$input.on("blur.tt",a).on("focus.tt",c).on("keydown.tt",d),!b.isMsie()||b.isMsie()>9?this.$input.on("input.tt",e):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){h[a.which||a.keyCode]||b.defer(b.bind(f._onInput,f,a))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(a,b){this.setInputValue(a),this._setQuery(a,b)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(a){this.$input.val(a),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b,c,d;a=this.getInputValue(),b=this.getHint(),c=a!==b&&0===b.indexOf(a),d=""!==a&&c&&!this.hasOverflow(),!d&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c,d;return a=this.$input.val().length,c=this.$input[0].selectionStart,b.isNumber(c)?c===a:!document.selection||(d=document.selection.createRange(),d.moveStart("character",-a),a===d.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=a("<div>")}}),c}(),h=function(){"use strict";function c(c,e){c=c||{},c.templates=c.templates||{},c.templates.notFound=c.templates.notFound||c.templates.empty,c.source||a.error("missing source"),c.node||a.error("missing node"),c.name&&!h(c.name)&&a.error("invalid dataset name: "+c.name),e.mixin(this),this.highlight=!!c.highlight,this.name=c.name||j(),this.limit=c.limit||5,this.displayFn=d(c.display||c.displayKey),this.templates=g(c.templates,this.displayFn),this.source=c.source.__ttAdapter?c.source.__ttAdapter():c.source,this.async=b.isUndefined(c.async)?this.source.length>2:!!c.async,this._resetLastSuggestion(),this.$el=a(c.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function d(a){function c(b){return b[a]}return a=a||b.stringify,b.isFunction(a)?a:c}function g(c,d){function e(b){return a("<div>").text(d(b))}return{notFound:c.notFound&&b.templatify(c.notFound),pending:c.pending&&b.templatify(c.pending),header:c.header&&b.templatify(c.header),footer:c.footer&&b.templatify(c.footer),suggestion:c.suggestion||e}}function h(a){return/^[_a-zA-Z0-9-]+$/.test(a)}var i,j;return i={val:"tt-selectable-display",obj:"tt-selectable-object"},j=b.getIdGenerator(),c.extractData=function(b){var c=a(b);return c.data(i.obj)?{val:c.data(i.val)||"",obj:c.data(i.obj)||null}:null},b.mixin(c.prototype,e,{_overwrite:function(a,b){b=b||[],b.length?this._renderSuggestions(a,b):this.async&&this.templates.pending?this._renderPending(a):!this.async&&this.templates.notFound?this._renderNotFound(a):this._empty(),this.trigger("rendered",this.name,b,!1)},_append:function(a,b){b=b||[],b.length&&this.$lastSuggestion.length?this._appendSuggestions(a,b):b.length?this._renderSuggestions(a,b):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(a),this.trigger("rendered",this.name,b,!0)},_renderSuggestions:function(a,b){var c;c=this._getSuggestionsFragment(a,b),this.$lastSuggestion=c.children().last(),this.$el.html(c).prepend(this._getHeader(a,b)).append(this._getFooter(a,b))},_appendSuggestions:function(a,b){var c,d;c=this._getSuggestionsFragment(a,b),d=c.children().last(),this.$lastSuggestion.after(c),this.$lastSuggestion=d},_renderPending:function(a){var b=this.templates.pending;this._resetLastSuggestion(),b&&this.$el.html(b({query:a,dataset:this.name}))},_renderNotFound:function(a){var b=this.templates.notFound;this._resetLastSuggestion(),b&&this.$el.html(b({query:a,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(c,d){var e,g=this;return e=document.createDocumentFragment(),b.each(d,function(b){var d,f;f=g._injectQuery(c,b),d=a(g.templates.suggestion(f)).data(i.obj,b).data(i.val,g.displayFn(b)).addClass(g.classes.suggestion+" "+g.classes.selectable),e.appendChild(d[0])}),this.highlight&&f({className:this.classes.highlight,node:e,pattern:c}),a(e)},_getFooter:function(a,b){return this.templates.footer?this.templates.footer({query:a,suggestions:b,dataset:this.name}):null},_getHeader:function(a,b){return this.templates.header?this.templates.header({query:a,suggestions:b,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=a()},_injectQuery:function(a,c){return b.isObject(c)?b.mixin({_query:a},c):c},update:function(b){function c(a){g||(g=!0,a=(a||[]).slice(0,e.limit),h=a.length,e._overwrite(b,a),h<e.limit&&e.async&&e.trigger("asyncRequested",b))}function d(c){c=c||[],!f&&h<e.limit&&(e.cancel=a.noop,h+=c.length,e._append(b,c.slice(0,e.limit-h)),e.async&&e.trigger("asyncReceived",b))}var e=this,f=!1,g=!1,h=0;this.cancel(),this.cancel=function(){f=!0,e.cancel=a.noop,e.async&&e.trigger("asyncCanceled",b)},this.source(b,c,d),!g&&c([])},cancel:a.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=a("<div>")}}),c}(),i=function(){"use strict";function c(c,d){function e(b){var c=f.$node.find(b.node).first();return b.node=c.length?c:a("<div>").appendTo(f.$node),new h(b,d)}var f=this;c=c||{},c.node||a.error("node is required"),d.mixin(this),this.$node=a(c.node),this.query=null,this.datasets=b.map(c.datasets,e)}return b.mixin(c.prototype,e,{_onSelectableClick:function(b){this.trigger("selectableClicked",a(b.currentTarget))},_onRendered:function(a,b,c,d){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",b,c,d)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function a(a){return a.isEmpty()}return b.every(this.datasets,a)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var a=this.getActiveSelectable();a&&a.removeClass(this.classes.cursor)},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.outerHeight(!0),d=this.$node.scrollTop(),e=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),b<0?this.$node.scrollTop(d+b):e<c&&this.$node.scrollTop(d+(c-e))},bind:function(){var a,c=this;return a=b.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,a),b.each(this.datasets,function(a){a.onSync("asyncRequested",c._propagate,c).onSync("asyncCanceled",c._propagate,c).onSync("asyncReceived",c._propagate,c).onSync("rendered",c._onRendered,c).onSync("cleared",c._onCleared,c)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(a){this.$node.attr("dir",a)},selectableRelativeToCursor:function(a){var b,c,d,e;return c=this.getActiveSelectable(),b=this._getSelectables(),d=c?b.index(c):-1,e=d+a,e=(e+1)%(b.length+1)-1,e=e<-1?b.length-1:e,e===-1?null:b.eq(e)},setCursor:function(a){this._removeCursor(),(a=a&&a.first())&&(a.addClass(this.classes.cursor),this._ensureVisible(a))},getSelectableData:function(a){return a&&a.length?h.extractData(a):null},getActiveSelectable:function(){var a=this._getSelectables().filter(this.selectors.cursor).first();return a.length?a:null},getTopSelectable:function(){var a=this._getSelectables().first();return a.length?a:null},update:function(a){function c(b){b.update(a)}var d=a!==this.query;return d&&(this.query=a,b.each(this.datasets,c)),d},empty:function(){function a(a){a.clear()}b.each(this.datasets,a),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function c(a){a.destroy()}this.$node.off(".tt"),this.$node=a("<div>"),b.each(this.datasets,c)}}),c}(),j=function(){"use strict";function a(){i.apply(this,[].slice.call(arguments,0))}var c=i.prototype;return b.mixin(a.prototype,i.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),c.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),c.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),c._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),c._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(a){return this.$node.css("ltr"===a?this.css.ltr:this.css.rtl),c.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),a}(),k=function(){"use strict";function c(c,e){var f,g,h,i,j,k,l,m,n,o,p;c=c||{},c.input||a.error("missing input"),c.menu||a.error("missing menu"),c.eventBus||a.error("missing event bus"),e.mixin(this),this.eventBus=c.eventBus,this.minLength=b.isNumber(c.minLength)?c.minLength:1,this.input=c.input,this.menu=c.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),f=d(this,"activate","open","_onFocused"),g=d(this,"deactivate","_onBlurred"),h=d(this,"isActive","isOpen","_onEnterKeyed"),i=d(this,"isActive","isOpen","_onTabKeyed"),j=d(this,"isActive","_onEscKeyed"),k=d(this,"isActive","open","_onUpKeyed"),l=d(this,"isActive","open","_onDownKeyed"),m=d(this,"isActive","isOpen","_onLeftKeyed"),n=d(this,"isActive","isOpen","_onRightKeyed"),o=d(this,"_openIfActive","_onQueryChanged"),p=d(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",f,this).onSync("blurred",g,this).onSync("enterKeyed",h,this).onSync("tabKeyed",i,this).onSync("escKeyed",j,this).onSync("upKeyed",k,this).onSync("downKeyed",l,this).onSync("leftKeyed",m,this).onSync("rightKeyed",n,this).onSync("queryChanged",o,this).onSync("whitespaceChanged",p,this).onSync("langDirChanged",this._onLangDirChanged,this)}function d(a){var c=[].slice.call(arguments,1);return function(){var d=[].slice.call(arguments);b.each(c,function(b){return a[b].apply(a,d)})}}return b.mixin(c.prototype,{_hacks:function(){var c,d;c=this.input.$input||a("<div>"),d=this.menu.$node||a("<div>"),c.on("blur.tt",function(a){var e,f,g;e=document.activeElement,f=d.is(e),g=d.has(e).length>0,b.isMsie()&&(f||g)&&(a.preventDefault(),a.stopImmediatePropagation(),b.defer(function(){c.focus()}))}),d.on("mousedown.tt",function(a){a.preventDefault()})},_onSelectableClicked:function(a,b){this.select(b)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(a,b,c,d){this._updateHint(),this.eventBus.trigger("render",c,d,b)},_onAsyncRequested:function(a,b,c){this.eventBus.trigger("asyncrequest",c,b)},_onAsyncCanceled:function(a,b,c){this.eventBus.trigger("asynccancel",c,b)},_onAsyncReceived:function(a,b,c){this.eventBus.trigger("asyncreceive",c,b)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(a,b){var c;(c=this.menu.getActiveSelectable())&&this.select(c)&&b.preventDefault()},_onTabKeyed:function(a,b){var c;(c=this.menu.getActiveSelectable())?this.select(c)&&b.preventDefault():(c=this.menu.getTopSelectable())&&this.autocomplete(c)&&b.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(a,b){this._minLengthMet(b)?this.menu.update(b):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(a,b){this.dir!==b&&(this.dir=b,this.menu.setLanguageDirection(b))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(a){return a=b.isString(a)?a:this.input.getQuery()||"",a.length>=this.minLength},_updateHint:function(){var a,c,d,e,f,h,i;a=this.menu.getTopSelectable(),c=this.menu.getSelectableData(a),d=this.input.getInputValue(),!c||b.isBlankString(d)||this.input.hasOverflow()?this.input.clearHint():(e=g.normalizeQuery(d),f=b.escapeRegExChars(e),h=new RegExp("^(?:"+f+")(.+$)","i"),i=h.exec(c.val),i&&this.input.setHint(d+i[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(a){this.input.setQuery(b.toStr(a))},getVal:function(){return this.input.getQuery()},select:function(a){var b=this.menu.getSelectableData(a);return!(!b||this.eventBus.before("select",b.obj))&&(this.input.setQuery(b.val,!0),this.eventBus.trigger("select",b.obj),this.close(),!0)},autocomplete:function(a){var b,c,d;return b=this.input.getQuery(),c=this.menu.getSelectableData(a),d=c&&b!==c.val,!(!d||this.eventBus.before("autocomplete",c.obj))&&(this.input.setQuery(c.val),this.eventBus.trigger("autocomplete",c.obj),!0)},moveCursor:function(a){var b,c,d,e,f;return b=this.input.getQuery(),c=this.menu.selectableRelativeToCursor(a),d=this.menu.getSelectableData(c),e=d?d.obj:null,f=this._minLengthMet()&&this.menu.update(b),!f&&!this.eventBus.before("cursorchange",e)&&(this.menu.setCursor(c),d?this.input.setInputValue(d.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",e),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),c}();!function(){"use strict";function e(b,c){b.each(function(){var b,d=a(this);(b=d.data(p.typeahead))&&c(b,d)})}function f(a,b){return a.clone().addClass(b.classes.hint).removeData().css(b.css.hint).css(l(a)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function h(a,b){a.data(p.attrs,{dir:a.attr("dir"),autocomplete:a.attr("autocomplete"),spellcheck:a.attr("spellcheck"),style:a.attr("style")}),a.addClass(b.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!a.attr("dir")&&a.attr("dir","auto")}catch(c){}return a}function l(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function m(a){var c,d;c=a.data(p.www),d=a.parent().filter(c.selectors.wrapper),b.each(a.data(p.attrs),function(c,d){b.isUndefined(c)?a.removeAttr(d):a.attr(d,c)}),a.removeData(p.typeahead).removeData(p.www).removeData(p.attr).removeClass(c.classes.input),d.length&&(a.detach().insertAfter(d),d.remove())}function n(c){var d,e;return d=b.isJQuery(c)||b.isElement(c),e=d?a(c).first():[],e.length?e:null}var o,p,q;o=a.fn.typeahead,p={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},q={initialize:function(e,l){function m(){var c,m,q,r,s,t,u,v,w,x,y;b.each(l,function(a){a.highlight=!!e.highlight}),c=a(this),m=a(o.html.wrapper),q=n(e.hint),r=n(e.menu),s=e.hint!==!1&&!q,t=e.menu!==!1&&!r,s&&(q=f(c,o)),t&&(r=a(o.html.menu).css(o.css.menu)),q&&q.val(""),c=h(c,o),(s||t)&&(m.css(o.css.wrapper),c.css(s?o.css.input:o.css.inputWithNoHint),c.wrap(m).parent().prepend(s?q:null).append(t?r:null)),y=t?j:i,u=new d({el:c}),v=new g({hint:q,input:c},o),w=new y({node:r,datasets:l},o),x=new k({input:v,menu:w,eventBus:u,minLength:e.minLength},o),c.data(p.www,o),c.data(p.typeahead,x)}var o;return l=b.isArray(l)?l:[].slice.call(arguments,1),e=e||{},o=c(e.classNames),this.each(m)},isEnabled:function(){var a;return e(this.first(),function(b){a=b.isEnabled()}),a},enable:function(){return e(this,function(a){a.enable()}),this},disable:function(){return e(this,function(a){a.disable()}),this},isActive:function(){var a;return e(this.first(),function(b){a=b.isActive()}),a},activate:function(){return e(this,function(a){a.activate()}),this},deactivate:function(){return e(this,function(a){a.deactivate()}),this},isOpen:function(){var a;return e(this.first(),function(b){a=b.isOpen()}),a},open:function(){return e(this,function(a){a.open()}),this},close:function(){return e(this,function(a){a.close()}),this},select:function(b){var c=!1,d=a(b);return e(this.first(),function(a){c=a.select(d)}),c},autocomplete:function(b){var c=!1,d=a(b);return e(this.first(),function(a){c=a.autocomplete(d)}),c},moveCursor:function(a){var b=!1;return e(this.first(),function(c){b=c.moveCursor(a)}),b},val:function(a){var b;return arguments.length?(e(this,function(b){b.setVal(a)}),this):(e(this.first(),function(a){b=a.getVal()}),b)},destroy:function(){return e(this,function(a,b){m(b),a.destroy()}),this}},a.fn.typeahead=function(a){return q[a]?q[a].apply(this,[].slice.call(arguments,1)):q.initialize.apply(this,arguments)},a.fn.typeahead.noConflict=function(){return a.fn.typeahead=o,this}}()}),/*--------------------------------------------------------------------------
  --------------------------------------------------------------------------
  *
  *                                Taper
  *
  --------------------------------------------------------------------------
---------------------------------------------------------------------------*/
/* float-labels
/* https://github.com/geminilabs/float-labels.js/tree/master
----------------------------------------------------------------------------
----------------------------------------------------------------------------
---------------------------------------------------------------------------*/
doseParam(),daysParam(),/* pickadate
/* https://github.com/amsul/pickadate.js
----------------------------------------------------------------------------
----------------------------------------------------------------------------
---------------------------------------------------------------------------*/
datePicker(),// datepicker()
// snap popup to bottom on mobile browsers
mobile?($(".picker__frame").css({bottom:"0","margin-bottom":"0",top:"auto"}),$(".picker__box").css({"border-radius":"0","border-bottom-width":"0"})):$(".picker__frame").css({top:"15%"}),
// Taper start date, hover color
$('#datepicker-addon .fa-calendar-o, [id$="_date"]').on("mouseover mouseout",function(){$('#datepicker-addon .fa-calendar-o, [id$="_date"]').toggleClass("cal-hover")}),/* iCheck
/* https://github.com/fronteed/iCheck/
----------------------------------------------------------------------------
----------------------------------------------------------------------------
---------------------------------------------------------------------------*/
checkBoxes(),checkboxResize();// checkbox_resize()
/* typeahead
/* https://github.com/twitter/typeahead.js/
----------------------------------------------------------------------------
----------------------------------------------------------------------------
---------------------------------------------------------------------------*/
var substringMatcher=function(a){return function(b,c){var d;
// an array that will be populated with substring matches
d=[],
// regex used to determine if a string contains the substring `q`
substrRegex=new RegExp(b,"i"),
// iterate through the pool of strings and for any string that
// contains the substring `q`, add it to the `matches` array
$.each(a,function(a,b){substrRegex.test(b)&&d.push(b)}),c(d)}},meds=["Prednisone","Methylprednisolone"],rx_typeahead=$("#taper_med").typeahead({hint:!0,highlight:!0,minLength:0},{name:"prescription",source:substringMatcher(meds)}).bind("focus",function(){$(this).data("initial_value",$(this).val()),rx_typeahead.typeahead("val","")}).bind("blur",function(){var a=$(this).data("initial_value"),b=$(this).val();b?rx_typeahead.typeahead("val",b):rx_typeahead.typeahead("val",a)});$(".typeahead").on("typeahead:selected",onSelected).on("typeahead:autocompleted",onAutocompleted),
// if user presses enter (13) or tab (9) select the hint
$("[id$=_form]").on("keydown",".twitter-typeahead #taper_med",function(a){13!=a.which&&9!=a.which||(a.preventDefault(),$(".tt-selectable").first().click())}),/*--------------------------------------------------------------------------
  --------------------------------------------------------------------------
  *
  *                        Initial Phase Controls
  *
  --------------------------------------------------------------------------
---------------------------------------------------------------------------*/
// add initial controls to last non-linear phase
$.fn.nonLinearControls=function(){
//console.log('this nonLinearControls', this)
var a=$("<div/>",{"class":"phase-add-delete animated slideInRight"}).append($("<div>",{id:"del","class":"phase-del"})).append($("<div>",{id:"add","class":"phase-add"})).append($("<div>",{id:"calc","class":"taper-calc"}));this.append(a),$(".phase-add, .phase-del, .taper-calc").on("mouseover",function(){$(this).filter(":not(:animated)").animate({width:"100%"},"fast")}).on("mouseout touchend",function(){$(this).animate({width:"80%"},"fast")})},// nonLinearControls()
$.fn.linearControls=function(){
//console.log('this linearControls', this)
var a=$("<div/>",{"class":"phase-add-delete"}).append($("<div>",{id:"ldel","class":"phase-empty"})).append($("<div>",{id:"ladd","class":"phase-add animated slideInRight"})).append($("<div>",{id:"calc","class":"taper-calc animated slideInRight"}));this.append(a),$(".phase-add, .phase-del, .taper-calc").on("mouseover",function(){$(this).filter(":not(:animated)").animate({width:"100%"},"fast")}).on("mouseout touchend",function(){$(this).animate({width:"80%"},"fast")})},// phaseQod()
$(".phase.non-linear").last().nonLinearControls(),$(".phase.linear").linearControls(),phaseQod(),/*--------------------------------------------------------------------------
  --------------------------------------------------------------------------
  *
  *                            Database
  *
  --------------------------------------------------------------------------
---------------------------------------------------------------------------*/
/* remember user input when focus is lost
---------------------------------------------------------------------------*/
$.fn.onFocus=function(){this.focus(function(a){var b=$(this).val().replace(/[^0-9\.]/g,"");$(this).data("initial_value",$(this).val()),$(this).data("initial_number",b),""!=b?$(this).val(b):$(this).val("")})},$.fn.onBlur=function(){this.blur(function(a){""==$(this).val()?$(this).val(""):$(this).val()==$(this).data("initial_number")&&$(this).val($(this).data("initial_value"))})},/* add "mg" to dose and "days" to duration & validate input
---------------------------------------------------------------------------*/
$.fn.doseInput=function(){this.keypress(function(a){return isDose(a,$(this))}),this.on("change",function(){var a=parseFloat($(this).val())||"",b=a+" mg";""==a?$(this).val(""):$(this).val(b)})},$.fn.daysInput=function(){this.keypress(function(a){return isDays(a,$(this))}).on("change blur",function(){var a=parseFloat($(this).val())||"",b=1==a?" day":" days",c=a+b;""==a?$(this).val(""):$(this).val(c)}).on("keyup keydown",function(a){$label=$(this).prev();var b=parseFloat($(this).val())||"";if(""!=b){var c=Math.floor(parseInt(b,10)/7),d=parseInt(b,10)%7,e=1==c?" Week, ":" Weeks, ",f=1==d?" Day":" Days";
// there are weeks
if(0!=c)if(0!=d)var g=c+e+d+f;else var e=1==c?" Week":" Weeks",g=c+e;else var g=f;$label.html(g)}})},/* generate sentence for linear input
---------------------------------------------------------------------------*/
$.fn.linearInput=function(){this.on("keyup keydown",function(a){13==a.which&&(a.preventDefault(),$(this).blur()),$inst=$(".instructions span");var b=$("#start_mg").val().replace(/[^0-9\.]/g,""),c=$("#stop_mg").val().replace(/[^0-9\.]/g,""),d=$("#step_mg").val().replace(/[^0-9\.]/g,""),e=$("#step_time").val().replace(/[^0-9\.]/g,""),f=""!=b?[1,b]:[0,"_ "],g=""!=c?[1,c]:[0,"_ "],h=""!=d?[1,d]:[0,"_ "],i=""!=e?[1,e]:[0,"_"],j="Start at "+f[1]+"mg",k="Stop at "+g[1]+"mg",l="Decrease by "+h[1]+"mg",m=" every "+i[1]+" days.";if(f[0])var n=j+", "+k+", "+l+m;if(!f[0])var n="";$inst.html(n)})},/* Advancing and retreating with keys tab, enter, and delete.
 * 
 * 8  = delete
 * 9  = tab
 * 13 = enter
---------------------------------------------------------------------------*/
// dose text field
$("[id$=_form]").on("keydown","[id$=_dose]",function(a){var b=a.which;if(8==b||13==b){var c=a.target.id,d=($("[id$=_dose]:last").attr("id"),$(this).val());
// retreat to previous phase duration if delete key pressed
if(8==b&&""==d&&"p2_dose"==c){a.preventDefault();var e=$(this).closest("form").find(".param-input");return $(this).blur(),void e.slice(-3,-2).focus()}
// blur & set 'mg' value if enter pressed
return 8==b&&""==d?(a.preventDefault(),void $("#del").trigger("click")):13==b?(a.preventDefault(),void $(this).blur()):void 0}}),
// days text field
$("[id$=_form]").on("keydown","[id$=_days]",function(a){var b=a.which;if(8==b||9==b||13==b){var c=a.target.id,d=$("[id$=_days]:last").attr("id"),e=$(this).val();
//console.log('keypress', days, last, value)
// retreat to previous field if delete pressed
if(8==b&&""==e){a.preventDefault();var f=$(this).closest(".phase-params").find(".param-input");return $(this).blur(),void f.slice(-2,-1).focus()}
// if on last phase duration, and tab is pressed, create new phase
// if on last phase duration, and tab is pressed, create new phase
// blur & set 'days' value if enter pressed
return 9==b&&c==d?(a.preventDefault(),void $("#add").trigger("click")):13==b?(a.preventDefault(),void $(this).blur()):void 0}}),$("[id$=_dose], [id$=_days], [id$=_mg], [id$=_time]").each(function(a){var b=$(this),c=b[0].id;b.onFocus(),b.onBlur(),~c.indexOf("dose")?b.doseInput():~c.indexOf("days")?b.daysInput():~c.indexOf("mg")?(b.doseInput(),b.linearInput()):~c.indexOf("time")&&(b.daysInput(),b.linearInput())}),$("[id$=_taper]").on("click","#add, #ladd",function(a){$(this).closest("form").find(":input").slice(-1).blur(),"ladd"==a.target.id&&($("#ladd").addClass("phase-empty animated slideOutRight"),$("#pl #calc").removeClass("slideInRight").addClass("slideOutRight"));
// increment phase number
var b="ladd"==a.target.id?0:1;$.each($(".phase.non-linear"),function(){parseInt($(this).data("id"))>b&&(b=parseInt($(this).data("id")))}),b++;var c=b,d="p"+b,e=$("<div/>",{id:d,"data-id":c,"class":"row phase non-linear animated"});if($("#l_taper").length)var f=$("<div/>",{"class":"nl-phase-label",unselectable:"on",html:"Non-Linear"});else var f=$("<div/>",{"class":"phase-label",unselectable:"on",html:"Phase "+c});f.appendTo(e);var g=$("<div/>",{"class":"phase-qod-wrapper"}).append($("<div/>",{"class":"phase-qod"}).append($("<input/>",{"class":"phase-qod",id:"nl_qod_"+c,name:"nl_qod_"+c,type:"hidden",value:"0"})));g.appendTo(e);var h=$("<div/>",{"class":"col-xs-2 phase-num v-align"}).append($("<p/>",{unselectable:"on",html:c}));h.appendTo(e);var i=$("<div/>",{"class":"col-xs-7 pull-xs-3 col-sm-8 pull-sm-2 col-md-9 pull-md-1 phase-params"}),j=$("<div/>",{"class":"row"}),k=$("<div/>",{"class":"col-md-6 dose-param"}),l=$("<label/>",{"class":"param-label","for":d+"_dose",html:"Dose"}),m=$("<input/>",{"class":"param-input",type:"tel",id:d+"_dose",name:d+"_dose"});l.appendTo(k),m.appendTo(k);
// days
var n=$("<div/>",{"class":"col-md-6 days-param"}),o=$("<label/>",{id:d+"_days_label","class":"param-label","for":d+"_days",html:"Days"}),p=$("<input/>",{"class":"param-input",type:"tel",id:d+"_days",name:d+"_days"});o.appendTo(n),p.appendTo(n),
// build .phase div
k.appendTo(j),n.appendTo(j),j.appendTo(i),i.appendTo(e),
// append phase div
e.appendTo($("[id$=_form] .container-fluid")),
// dose input functions
m.onFocus(),m.onBlur(),m.doseInput(),
// days input functions
p.onFocus(),p.onBlur(),p.daysInput(),
// apply float labels
doseParam(),daysParam(),
// show new phase
e.addClass("slideInRight").one(animation_end,function(){var a=$(this).closest("form").find(":input");a.slice(-2,-1).focus()}),
// show controls on new phase
$(".phase.linear").length&&1==$(".phase.non-linear").length?$(".phase.non-linear").last().nonLinearControls():newControls(e),$("html, body").animate({scrollTop:e.offset().top},500)}),$("[id$=_taper]").on("click","#del, #ldel",function(a){var b=0!=$(".phase.linear").length;if("ldel"==a.target.id?($("#pl #calc").removeClass("slideOutRight").addClass("slideInRight"),$("#ladd").addClass("slideInRight").removeClass("phase-empty slideOutRight")):$("#p2").length||($("#ldel").removeClass("slideInRight").addClass("slideOutRight").one(animation_end,function(){$(this).addClass("phase-empty").removeClass("phase-del animated slideInRight")}),$("#ladd").addClass("slideInRight").removeClass("phase-empty slideOutRight"),$("#pl #calc").removeClass("slideOutRight").addClass("slideInRight")),2!=$(".phase").length||0!=b){if(0==b)var c=$(".phase").slice(2).last();else var c=$(".phase").slice(1).last();if(1==b&&$(".phase").length>2||0==b){var d=$(".non-linear .phase-add-delete"),e="slideInRight",f="slideOutRight";d.removeClass(e).addClass(f).one(animation_end,function(){$(this).removeClass(f)})}c.removeClass("slideInRight").addClass("slideOutRight").one(animation_end,function(){$(this).slideToggle("fast","linear",function(){c.detach()}),(1==b&&$(".phase").length>2||0==b)&&d.addClass(e).appendTo(c.prev());var a=$(this).closest("form").find(":input");a.slice(-4,-3).focus()})}});